<div class="row inbox" data-ng-init="init()">
    <div class="col-md-3">
        <div class="panel panel-default animation" data-ng-cloak>
            <div class="panel-body">
                <form class="form-horizontal" data-ng-submit="sendMessage()">
                    <div class="form-group">
                        <label for="recipient" class="control-label col-md-1">To</label>
                        <div class="col-md-11" id="recipient">
                            <ui-select data-ng-model="newMessage.recipient" theme="bootstrap">
                                <ui-select-match placeholder="Select recipient...">{{$select.selected.userName}}</ui-select-match>
                                <ui-select-choices repeat="user in users | filter: $select.search track by user.userName"
                                                   refresh="getUsers($select.search)"
                                                   refresh-delay="500">
                                    <img class="avatar" data-ng-src="avatar/{{user.userName}}" >
                                    <div data-ng-bind-html="user.userName | highlight: $select.search"></div>
                                    <div data-ng-bind-html="user.about | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="text" class="control-label col-md-1">Text</label>
                        <div class="col-md-11">
                                <textarea id="text"
                                          data-ng-model="newMessage.message.text"
                                          class="form-control"
                                          placeholder="Enter text"></textarea>
                        </div>
                    </div>
                    <button id="btn-send-message" type="submit" class="btn btn-primary">
                        <i class="glyphicon glyphicon-send"></i> Send
                    </button>
                </form>
            </div>
        </div>
    </div>
    <div class="col-md-9">
        <div class="pull-right">
            <span class="text-muted"><b>{{start(messages)}}</b>â€“<b>{{end(messages)}}</b> of <b>{{totalCount()}}</b></span>
            <div class="btn-group btn-group-sm">
                <button type="button"
                        class="btn btn-default"
                        data-ng-disabled="!messages._links.previousPage"
                        data-ng-click="loadPrevious()">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                </button>
                <button type="button"
                        class="btn btn-default"
                        data-ng-disabled="!messages._links.nextPage"
                        data-ng-click="loadNext()">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                </button>
            </div>
        </div>

        <div class="panel-body">
            <ul class="chat">
                <li class="left clearfix" data-ng-repeat="message in messages.messages">
                        <span class="chat-img pull-left">
                            <img data-ng-src="avatar/{{message.from}}" alt="User Avatar" class="avatar img-circle" />
                        </span>
                    <div class="chat-body clearfix">
                        <div class="header">
                            <strong class="primary-font">{{message.from}}</strong><br>
                            <small class="text-muted">
                                <span class="glyphicon glyphicon-circle-arrow-right"></span>
                                {{message.to}}
                            </small>
                            <small class="text-muted pull-right">
                                <span class="glyphicon glyphicon-time"></span>
                                {{message.created | date:'yyyy-MM-dd HH:mm'}}
                            </small>
                        </div>
                        <p class="message-text" data-ng-bind-html="message.text | emojify | markdown">
                        </p>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>